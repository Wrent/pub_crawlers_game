<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0068)http://craftyjs.github.com/tutorial/getting-started/how-crafty-works -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
	<title>Crafty - How Crafty Works</title>
	<link type="text/css" rel="stylesheet" href="./Crafty - How Crafty Works_files/global.css">
	<link href="./Crafty - How Crafty Works_files/css" rel="stylesheet" type="text/css">
	<link rel="shortcut icon" href="http://craftyjs.github.com/favicon.ico">
	<script type="text/javascript" async="" src="./Crafty - How Crafty Works_files/ga.js"></script><script src="./Crafty - How Crafty Works_files/jquery.min.js" type="text/javascript"></script>
	<link href="./Crafty - How Crafty Works_files/pygments_style.css" type="text/css" rel="stylesheet">
	<script type="text/javascript">

		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-23935213-2']);
		_gaq.push(['_trackPageview']);

		(function () {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();

</script>
<meta name="chromesniffer" id="chromesniffer_meta" content="{&quot;Google Analytics&quot;:-1,&quot;GoogleFontApi&quot;:-1,&quot;jQuery&quot;:&quot;1.5.2&quot;}"><script type="text/javascript" src="chrome-extension://homgcnaoacgigpkkljjjekpignblkeae/detector.js"></script></head>
<body>
	<div id="header">
		<div id="inner">
			<a href="http://craftyjs.com/">
				<img id="logo" src="./Crafty - How Crafty Works_files/logo.png" alt="Crafty - JavaScript HTML5 Game Engine"></a>
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/">Getting Started</a></li>
				<li><a href="http://craftyjs.com/api/">Documentation</a></li>
				<li><a href="https://groups.google.com/forum/#!forum/craftyjs">Forum</a></li>
				<li><a href="http://craftycomponents.com/">Modules</a></li>
				<li><a href="http://craftyjs.tumblr.com/">Blog</a></li>
				<li class="emph"><a href="http://craftyjs.com/download.php">Download</a></li>
			</ul>
		</div>
	</div>
	<div id="main">
		<div id="main-left">
		</div>
		<div id="main-right">
		</div>
		<div id="content">
			
			<div id="doc-nav">
	<ul id="doc-level-one">
		<li>
			Getting started
			<ul>
				<li><a href="./Crafty - How Crafty Works_files/Crafty - How Crafty Works.htm">How Crafty works</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/getting-started/download-and-setup">Download and setup</a></li>
			</ul>
		</li>
		<li>
			Entities and components
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/entities-components/providing-structure">Providing structure</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/entities-components/a-game">Example game</a></li>
			</ul>
		</li>
		<li>
			Events
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/event-binding/fire-and-forget">communication</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/event-binding/a-game">Example game</a></li>
			</ul>
		</li>
		<li>
			Top-down game: Bananabomber
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/bananabomber/create-a-game">Create a game</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/bananabomber/graphics">Sprites and animations</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/bananabomber/input-and-events">Movement, controls, events</a></li>
			</ul>
		</li>
		<li>
			Administrative
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/administrative/structure">Structure</a></li>
			</ul>
		</li>
		<li>
			Resources
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/resources">Resources list</a></li>
			</ul>
		</li>

		<li>
			Flexpi integration
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/introduction">Introduction</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/custom-data-logging">Custom data logging</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/login-user-with-social">Login user with social</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/sell-premium-items-in-game">Sell premium items in game</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/add-badge-for-user">Add badge for user</a></li>
			</ul>
		</li>
	</ul>
</div>
<div id="doc-content">

<h2> How Crafty Works </h2>

	<p>( This will be the front page of Tutorial section )</p>

<h1 id="introduction">Introduction</h1>

<p>Crafty is a JavaScript game library that can help you create games in a structured way…</p>

<p>Key Features:</p>

<ul>
<li>Entities &amp; Components - A clean and decoupled way to organize game elements. No inheritance needed!</li>

<li>Canvas or DOM - Choose the technology to render your entities; it will look exactly the same.</li>

<li>Eventbinding - Event system for custom events that can be triggered whenever, whatever and bound just as easily.</li>
</ul>

<p>Other Goodies:</p>

<ul>
<li>Thriving community - Help is readily available in the forum.</li>

<li>Community modules - A constantly growing collection of user-generated code you can use.</li>

<li>Pure JavaScript - No magic. Works in all major browsers and can be combined with your favorite js library.</li>
</ul>

<h1 id="what_does_a_crafty_game_look_like">What does a Crafty game look like</h1>

<p>Entities are the basic building blocks in Crafty. Everything in your game that needs to interact with the world is an entity. A player entity could look like this:</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"2D, DOM, Twoway"</span><span class="p">).</span><span class="nx">twoway</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</code></pre>
</div>
<p>This creates an entity that is positioned in the 2D world, is drawn to the stage using DOM elements and can be moved left and right using the arrow keys at a speed of 3 pixls pr frame. If this seems a little magic to you it is because I haven’t introduced you to components yet.</p>

<p>A component is a reusable piece of functionality that can be added to one or more entities. You can add components when the entity is created, as we did above, or at any later point. Components can even add more components to its host entity. The following component moves its entity to a random place on the stage:</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">Crafty</span><span class="p">.</span><span class="nx">c</span><span class="p">(</span><span class="s2">"RandomPosition"</span><span class="p">,</span> <span class="p">{</span>
	<span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">Crafty</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">randomInt</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">350</span><span class="p">),</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">Crafty</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">randomInt</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">350</span><span class="p">)</span> <span class="p">});</span>
	<span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myEnt</span> <span class="o">=</span> <span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"2D, DOM, Twoway, RandomPosition, Color"</span><span class="p">).</span><span class="nx">twoway</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="nx">color</span><span class="p">(</span><span class="s2">"red"</span><span class="p">).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">w</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">50</span><span class="p">});</span>
</code></pre>
</div>
<p>I also changed the size of the entity and gave it a color so you can see it. You now have a fully runnable game - go ahead and add it to the skeleton from <a href="http://craftyjs.github.com/tutorial/getting-started/download-and-setup">Download and setup</a> to see for yourself!</p>

<p>Entities can react to events that occur in the game. Crafty provides a suite of build in events such as EnterFrame, Pause, SceneChange. Moving an entity one pixel to the left each frame is achieved by binding a function to the EnterFrame event</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">myEnt</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">"EnterFrame"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="o">--</span><span class="p">;</span>
<span class="p">})</span>
</code></pre>
</div>
<h1 id="a_simple_game_of_pong">A simple game of pong</h1>

<p>With these simple building blocks you can create a game of two player pong complete with paddles and scoreboard in some 50 lines of javascript!</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">Crafty</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="s1">'rgb(127,127,127)'</span><span class="p">);</span>

<span class="c1">//Paddles</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"Paddle, 2D, DOM, Color, Multiway"</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="s1">'rgb(255,0,0)'</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">100</span> <span class="p">})</span>
	<span class="p">.</span><span class="nx">multiway</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">{</span> <span class="nx">W</span><span class="o">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="nx">S</span><span class="o">:</span> <span class="mi">90</span> <span class="p">});</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"Paddle, 2D, DOM, Color, Multiway"</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="s1">'rgb(0,255,0)'</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">580</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">100</span> <span class="p">})</span>
	<span class="p">.</span><span class="nx">multiway</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">{</span> <span class="nx">UP_ARROW</span><span class="o">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="nx">DOWN_ARROW</span><span class="o">:</span> <span class="mi">90</span> <span class="p">});</span>

<span class="c1">//Ball</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"2D, DOM, Color, Collision"</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="s1">'rgb(0,0,255)'</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">150</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> 
			<span class="nx">dX</span><span class="o">:</span> <span class="nx">Crafty</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">randomInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> 
			<span class="nx">dY</span><span class="o">:</span> <span class="nx">Crafty</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">randomInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="p">})</span>
	<span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">'EnterFrame'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="c1">//hit floor or roof</span>
		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="mi">290</span><span class="p">)</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">dY</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
			<span class="nx">Crafty</span><span class="p">(</span><span class="s2">"LeftPoints"</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> 
				<span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">points</span> <span class="o">+</span> <span class="s2">" Points"</span><span class="p">)</span> <span class="p">});</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
			<span class="nx">Crafty</span><span class="p">(</span><span class="s2">"RightPoints"</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> 
				<span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">points</span> <span class="o">+</span> <span class="s2">" Points"</span><span class="p">)</span> <span class="p">});</span>
		<span class="p">}</span>

		<span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dX</span><span class="p">;</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dY</span><span class="p">;</span>
	<span class="p">})</span>
	<span class="p">.</span><span class="nx">onHit</span><span class="p">(</span><span class="s1">'Paddle'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">dX</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">})</span>

<span class="c1">//Score boards</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"LeftPoints, DOM, 2D, Text"</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">points</span><span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
	<span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"0 Points"</span><span class="p">);</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"RightPoints, DOM, 2D, Text"</span><span class="p">)</span>
	<span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">515</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">points</span><span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
	<span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"0 Points"</span><span class="p">);</span>
</code></pre>
</div>
<p>And the result</p>
<iframe src="./Crafty - How Crafty Works_files/pong.htm" id="gameframe" height="300" width="600">
	This is an iframe. sorry.
</iframe><script type="text/javascript">
	//Prevent the game from scrolling main page
    if (frames['gameframe']!=undefined)
      frames['gameframe'].focus(); // Works in all browser, except Firefox
    else
      document.getElementById('gameframe').focus();  // Works in Firefox
</script>
</div>

			
		</div>
	</div>
	<div class="clearer"> </div> <div id="footer"> <div id="contact"> <a href="http://twitter.com/craftyjs">
	<img src="./Crafty - How Crafty Works_files/twitter.png"> @craftyjs</a> <a href="http://webchat.freenode.net/">
	<img src="./Crafty - How Crafty Works_files/comment.png"> #crafty@freenode.net</a> <a href="https://groups.google.com/forum/#!forum/craftyjs">
	<img src="./Crafty - How Crafty Works_files/google.png"> google groups</a> <a href="mailto:louis@craftyjs.com">
	<img src="./Crafty - How Crafty Works_files/email.png"> louis@craftyjs.com</a> <a href="https://github.com/craftyjs/Crafty">
	<img src="./Crafty - How Crafty Works_files/github.png"> github</a> </div> <ul> <li><a href="http://craftyjs.com/api/">Documentation</a></li>
	<li><a href="http://craftycomponents.com/">Modules</a></li> <li><a href="https://groups.google.com/forum/#!forum/craftyjs">Forum</a></li>
	<li><a href="http://craftyjs.github.com/tutorial/">Tutorial</a></li> <li><a href="http://craftyjs.com/demos.php">Demos</a></li>
	<li><a href="http://craftyjs.tumblr.com/">Blog</a></li> <li><a href="http://craftyjs.com/download.php">Download</a></li>
	</ul> <p> © Crafty 2010. Crafty is distributed under the <a href="http://en.wikipedia.org/wiki/MIT_License">
	MIT</a> or <a href="http://en.wikipedia.org/wiki/GNU_General_Public_License">GPL</a>
	license.</p> </div>


</body></html>