<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0062)http://craftyjs.github.com/tutorial/bananabomber/create-a-game -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
	<title>Crafty - Creating your first Crafty game</title>
	<link type="text/css" rel="stylesheet" href="./Crafty - Creating your first Crafty game_files/global.css">
	<link href="./Crafty - Creating your first Crafty game_files/css" rel="stylesheet" type="text/css">
	<link rel="shortcut icon" href="http://craftyjs.github.com/favicon.ico">
	<script type="text/javascript" async="" src="./Crafty - Creating your first Crafty game_files/ga.js"></script><script src="./Crafty - Creating your first Crafty game_files/jquery.min.js" type="text/javascript"></script>
	<link href="./Crafty - Creating your first Crafty game_files/pygments_style.css" type="text/css" rel="stylesheet">
	<script type="text/javascript">

		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-23935213-2']);
		_gaq.push(['_trackPageview']);

		(function () {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();

</script>
<meta name="chromesniffer" id="chromesniffer_meta" content="{&quot;Google Analytics&quot;:-1,&quot;GoogleFontApi&quot;:-1,&quot;jQuery&quot;:&quot;1.5.2&quot;}"><script type="text/javascript" src="chrome-extension://homgcnaoacgigpkkljjjekpignblkeae/detector.js"></script></head>
<body>
	<div id="header">
		<div id="inner">
			<a href="http://craftyjs.com/">
				<img id="logo" src="./Crafty - Creating your first Crafty game_files/logo.png" alt="Crafty - JavaScript HTML5 Game Engine"></a>
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/">Getting Started</a></li>
				<li><a href="http://craftyjs.com/api/">Documentation</a></li>
				<li><a href="https://groups.google.com/forum/#!forum/craftyjs">Forum</a></li>
				<li><a href="http://craftycomponents.com/">Modules</a></li>
				<li><a href="http://craftyjs.tumblr.com/">Blog</a></li>
				<li class="emph"><a href="http://craftyjs.com/download.php">Download</a></li>
			</ul>
		</div>
	</div>
	<div id="main">
		<div id="main-left">
		</div>
		<div id="main-right">
		</div>
		<div id="content">
			
			<div id="doc-nav">
	<ul id="doc-level-one">
		<li>
			Getting started
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/getting-started/how-crafty-works">How Crafty works</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/getting-started/download-and-setup">Download and setup</a></li>
			</ul>
		</li>
		<li>
			Entities and components
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/entities-components/providing-structure">Providing structure</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/entities-components/a-game">Example game</a></li>
			</ul>
		</li>
		<li>
			Events
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/event-binding/fire-and-forget">communication</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/event-binding/a-game">Example game</a></li>
			</ul>
		</li>
		<li>
			Top-down game: Bananabomber
			<ul>
				<li><a href="./Crafty - Creating your first Crafty game_files/Crafty - Creating your first Crafty game.htm">Create a game</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/bananabomber/graphics">Sprites and animations</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/bananabomber/input-and-events">Movement, controls, events</a></li>
			</ul>
		</li>
		<li>
			Administrative
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/administrative/structure">Structure</a></li>
			</ul>
		</li>
		<li>
			Resources
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/resources">Resources list</a></li>
			</ul>
		</li>

		<li>
			Flexpi integration
			<ul>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/introduction">Introduction</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/custom-data-logging">Custom data logging</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/login-user-with-social">Login user with social</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/sell-premium-items-in-game">Sell premium items in game</a></li>
				<li><a href="http://craftyjs.github.com/tutorial/integrations/flexpi/add-badge-for-user">Add badge for user</a></li>
			</ul>
		</li>
	</ul>
</div>
<div id="doc-content">

<h2> Creating your first Crafty game </h2>

	<p>So - let’s get going!</p>

<p>First you need to grab the latest release of the <a href="http://www.craftyjs.com/">crafty</a> engine. At the moment this is 0.5.0. It happens that new versions introduces breaking changes. Ask in the <a href="https://groups.google.com/forum/#!forum/craftyjs">forum</a> if you run into problems.</p>

<p>Put the crafty.js file in your working directory. We will be working on an uncompressed version to make it easier to dig in and see what is going on. When the game is ready to be released we can replace it with a minified version that is much smaller.</p>

<p>The game and articles is a work in progress. You can download the latest sources for the game from <a href="https://github.com/sorenbs/bananabomber/blob/master/game.js">github</a></p>

<p>Now create the html file that will host the game:</p>
<div class="highlight"><pre><code class="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"crafty.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"game.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;title&gt;</span>My Crafty Game<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;style&gt;</span>
    <span class="nt">body</span><span class="o">,</span> <span class="nt">html</span> <span class="p">{</span> <span class="k">margin</span><span class="o">:</span><span class="m">0</span><span class="p">;</span> <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="k">overflow</span><span class="o">:</span><span class="k">hidden</span><span class="p">;</span> <span class="k">font-family</span><span class="o">:</span><span class="n">Arial</span><span class="p">;</span> <span class="k">font-size</span><span class="o">:</span><span class="m">20px</span> <span class="p">}</span>
    <span class="nf">#cr-stage</span> <span class="p">{</span> <span class="k">border</span><span class="o">:</span><span class="m">2px</span> <span class="k">solid</span> <span class="nb">black</span><span class="p">;</span> <span class="k">margin</span><span class="o">:</span><span class="m">5px</span> <span class="k">auto</span><span class="p">;</span> <span class="k">color</span><span class="o">:</span><span class="nb">white</span> <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>
<p>The game skeleton is pretty simple:</p>
<div class="highlight"><pre><code class="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//start crafty</span>
    <span class="nx">Crafty</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">336</span><span class="p">);</span>
    <span class="c1">//Crafty.canvas.init();</span>
<span class="p">};</span>
</code></pre>
</div>
<p>If you are familiar with javascript you will recognize this way of declaring a function that will get executed when the browser is done loading the page. In that way Crafty is no different from any other javascript you would write. Crafty.init(width, height) is where Crafty does it’s initialization stuff that is needed before the game can run. We are going to create a tile-based game so the width and height is set to multiples of 16, which is the size of the tiles.</p>

<p>There are two ways of getting images onto the screen:</p>

<ul>
<li>Using a canvas element that is like a big square of screen estate that you get to draw pixels on or</li>

<li>using normal DOM elements that you can manipulate using css and javascript but is drawn to the screen by the browser.</li>
</ul>

<p>It turns out that the DOM method is fastest in most cases, but if you want to use canvas you need to call Crafty.canvas.init() first. As you will see later Crafty abstracts away most differences between DOM and canvas, so it is a matter of changing a single variable if you decide to change later.</p>

<h2 id="scenes">Scenes</h2>

<p>To organize different parts of the game Crafty has a notion of scenes. Each level of a game would fit nicely in a scene as would the menu, high score lists etc. For our simple game we will just have a loading scene and a game scene:</p>
<div class="highlight"><pre><code class="javascript"><span class="c1">//the loading screen that will display while our assets load</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">scene</span><span class="p">(</span><span class="s2">"loading"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//load takes an array of assets and a callback when complete</span>
    <span class="nx">Crafty</span><span class="p">.</span><span class="nx">load</span><span class="p">([</span><span class="s2">"sprite.png"</span><span class="p">],</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">Crafty</span><span class="p">.</span><span class="nx">scene</span><span class="p">(</span><span class="s2">"main"</span><span class="p">);</span> <span class="c1">//when everything is loaded, run the main scene</span>
    <span class="p">});</span>

    <span class="c1">//black background with some loading text</span>
    <span class="nx">Crafty</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="s2">"#000"</span><span class="p">);</span>
    <span class="nx">Crafty</span><span class="p">.</span><span class="nx">e</span><span class="p">(</span><span class="s2">"2D, DOM, Text"</span><span class="p">).</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">h</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">150</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">120</span> <span class="p">})</span>
            <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"Loading"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">({</span> <span class="s2">"text-align"</span><span class="o">:</span> <span class="s2">"center"</span> <span class="p">});</span>
<span class="p">});</span>

<span class="c1">//automatically play the loading scene</span>
<span class="nx">Crafty</span><span class="p">.</span><span class="nx">scene</span><span class="p">(</span><span class="s2">"loading"</span><span class="p">);</span>
</code></pre>
</div>
<p>Code outside of a function will execute as the interpreter gets to it, so the last line will invoke Crafty.scene(“loading”) which in turn invokes the method that we have just associated with that scene.</p>

<p>In this scene we do two things. We tell crafty to go fetch some assets that we will need (our sprite sheet) and then call a function when that is done. This function will unload the “loading” scene and load the “main” scene that will run our game. If you are not familiar with functional/dynamic languages this syntax of inlining functions might be new to you, but it is very common in javascript, so you better get used to it :-)</p>

<p>Next we define a nice background and text to display while loading. The main scene is defined in much the same way:</p>
<div class="highlight"><pre><code class="javascript"><span class="nx">Crafty</span><span class="p">.</span><span class="nx">scene</span><span class="p">(</span><span class="s2">"main"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">generateWorld</span><span class="p">();</span>

<span class="p">});</span>
</code></pre>
</div>
<p>The first thing to do in the game scene is to populate the world with background, obstacles etc. But before we get to that, let me just briefly dwell on a central part of the Crafty design.</p>

<h2 id="components">Components</h2>

<p>In programming it is quite usual to use an approach called Object-Oriented Programming, or OOP, where code is organised in hierarchies of classes that can inherit functionality from ancestors while providing new functionality itself. Flash adopted this approach with AS3 released some years ago. This way of organizing code has some problems though and hence Crafty takes a different approach.</p>

<p>Crafty provides a system very similar to what is known as mixins, multiple inheritance or traits depending on the specific language. An easy way to think about this is that an entity (like say the player or an enemy) is composed of many reusable components that enhance the entity with some new functionality. One way to add components to an entity is to call Crafty.e(string) which will create a new entity with the functionality provided by the comma-separated list of components specified in the string parameter.</p>

<p>So what we did in the loading scene to get the background is we created an entity with the components 2D, DOM and Text. 2D provides functionality around positioning in 2d space(x, y, etc.). DOM provides functionality that will automatically draw the entity to the screen using dom elements, and Text… I think you guessed it. These components are defined in the crafty.js file and you can go have a look if you are curious, but we will get back to how these components are created in a later article.</p>

<p>Next up is world generation in the article <a href="http://craftyjs.github.com/tutorial/bananabomber/graphics">Tiles, spritemap and animations</a></p>
</div>

			
		</div>
	</div>
	<div class="clearer"> </div> <div id="footer"> <div id="contact"> <a href="http://twitter.com/craftyjs">
	<img src="./Crafty - Creating your first Crafty game_files/twitter.png"> @craftyjs</a> <a href="http://webchat.freenode.net/">
	<img src="./Crafty - Creating your first Crafty game_files/comment.png"> #crafty@freenode.net</a> <a href="https://groups.google.com/forum/#!forum/craftyjs">
	<img src="./Crafty - Creating your first Crafty game_files/google.png"> google groups</a> <a href="mailto:louis@craftyjs.com">
	<img src="./Crafty - Creating your first Crafty game_files/email.png"> louis@craftyjs.com</a> <a href="https://github.com/craftyjs/Crafty">
	<img src="./Crafty - Creating your first Crafty game_files/github.png"> github</a> </div> <ul> <li><a href="http://craftyjs.com/api/">Documentation</a></li>
	<li><a href="http://craftycomponents.com/">Modules</a></li> <li><a href="https://groups.google.com/forum/#!forum/craftyjs">Forum</a></li>
	<li><a href="http://craftyjs.github.com/tutorial/">Tutorial</a></li> <li><a href="http://craftyjs.com/demos.php">Demos</a></li>
	<li><a href="http://craftyjs.tumblr.com/">Blog</a></li> <li><a href="http://craftyjs.com/download.php">Download</a></li>
	</ul> <p> © Crafty 2010. Crafty is distributed under the <a href="http://en.wikipedia.org/wiki/MIT_License">
	MIT</a> or <a href="http://en.wikipedia.org/wiki/GNU_General_Public_License">GPL</a>
	license.</p> </div>


</body></html>